(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{161:function(t,e,r){},163:function(t,e,r){"use strict";var n=r(161);r.n(n).a},165:function(t,e,r){"use strict";r.r(e);var n=r(90),o=(r(99),r(101),r(45),r(46),r(100),r(44),r(5)),l={mounted:function(){var t=Object(o.a)(regeneratorRuntime.mark(function t(){var image,e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:(image=this.$refs.image).onload=function(){e.image.width=image.naturalWidth,e.image.height=image.naturalHeight},this.filterList();case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),methods:{handleFileUpload:function(){var t=Object(o.a)(regeneratorRuntime.mark(function t(){var e,data;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.$refs.file.files){t.next=2;break}return t.abrupt("return",null);case 2:if((e=this.$refs.file.files[0]).type.match(/^image/)){t.next=6;break}return this.error="Uploaded file is not an image. Try to upload another one, please!",t.abrupt("return",null);case 6:return t.next=8,c(e);case 8:data=t.sent,this.image.name=e.name,this.image.size=e.size,this.image.source=data,this.image.createdAt=new Date,this.uploadDialog=!0;case 14:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),saveImage:function(){var t=this;this.$db.insert(this.image,function(e,r){return e&&(t.error=e.message),t.success="Your image was successfully stored!",t.uploadDialog=!1,t.filterList(),null})},editImage:function(t){this.editMode=!0,this.editId=t._id,this.image=Object.assign({},t),this.uploadDialog=!0},updateImage:function(){var t=this;this.$db.update({_id:this.editId},this.image,function(e,r){if(t.editId="",t.editMode=!1,t.uploadDialog=!1,e)return t.error=e,null;t.success="You successfully updated the image!",t.filterList()})},removeImage:function(){var t=this;this.$db.remove({_id:this.imageToDelete},function(e,r){if(t.imageToDelete="",e)return t.error=e,null;t.success="You successfully deleted the image!",t.filterList()})},filterList:function(){var t=this;this.page=1;var e={$or:[{name:{$regex:new RegExp(this.filter,"gi")}},{tooltip:{$regex:new RegExp(this.filter,"gi")}}]};return this.cursor=this.$db.find(e).sort(Object(n.a)({},this.sort,this.sortAsc)),this.cursor.limit(this.limit).exec(function(e,data){if(e)return t.error=e,null;t.imageList=data}),this.$db.count(e,function(e,r){e&&(t.error=e),t.pages=Math.ceil(r/t.limit)}),!1},sortList:function(t){this.sort===t?this.sortAsc=1===this.sortAsc?-1:1:(this.sort=t,this.sortAsc=1),this.filterList()}},computed:{skip:function(){return(this.page-1)*this.limit}},watch:{page:function(t){var e=this;this.cursor.skip(this.skip).exec(function(t,data){if(t)return e.error=t,null;e.imageList=data})}},data:function(){return{file:"",positions:["Top","Bottom","Left","Right"],editMode:!1,editId:"",imageSource:"",imageList:[],dbCursor:null,filter:"",sort:"createdAt",sortAsc:1,image:{source:"",height:"",width:"",name:"",size:0,createdAt:"",tooltip:"",tooltipPosition:""},error:"",success:"",imageToDelete:"",uploadDialog:!1,page:1,pages:0,limit:10}}},c=function(t){var e=new FileReader;return new Promise(function(r,n){e.onload=function(){r(e.result)},e.readAsDataURL(t)})},v=l,d=(r(163),r(22)),component=Object(d.a)(v,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-layout",{attrs:{row:"","justify-center":"","align-center":""}},[r("v-flex",{attrs:{xs12:""}},[r("v-card",[r("v-card-title",{staticClass:"display-2"},[t._v("Tooltip Picture Manager")]),t._v(" "),r("v-card-text",[r("input",{ref:"file",attrs:{type:"file",hidden:"",accept:".png, .jpg, .jpeg, .svg, .gif",id:"file"},on:{change:t.handleFileUpload}}),t._v(" "),r("v-layout",{attrs:{row:"",wrap:"","pb-3":""}},[r("v-flex",{attrs:{xs10:"",sm9:"",id:"search-place"}},[r("v-text-field",{attrs:{name:"search",solo:"","hide-details":"","prepend-icon":"search",label:"Search",id:"search"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.filterList(e)}},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})],1),t._v(" "),r("v-flex",{attrs:{xs12:"",sm3:"","text-xs-right":""}},[r("v-btn",{attrs:{block:"",color:"primary"},nativeOn:{click:function(e){return e.preventDefault(),t.$refs.file.click(e)}}},[r("v-icon",{attrs:{left:""}},[t._v("publish")]),t._v(" Upload\n            ")],1)],1)],1),t._v(" "),r("v-divider"),t._v(" "),0===t.imageList.length?r("v-layout",{attrs:{row:"",wrap:"","pt-4":"","pb-1":""}},[r("v-flex",{attrs:{xs12:"","text-xs-center":""}},[t._v("\n            You have not uploaded any images yet!\n          ")])],1):t._e(),t._v(" "),t.imageList.length>0?r("div",[r("v-layout",{staticClass:"grey lighten-3",attrs:{row:"",wrap:"","pt-4":"","pb-1":"","hidden-sm-and-down":""}},[r("v-flex",{attrs:{xs1:"","pl-2":""}},[t._v("Preview")]),t._v(" "),r("v-flex",{staticClass:"sortable",attrs:{xs4:"","pl-2":"","pr-2":""},on:{click:function(e){return t.sortList("tooltip")}}},[t._v("Tooltip")]),t._v(" "),r("v-flex",{staticClass:"sortable",attrs:{xs2:"","pl-2":"","pr-2":""},on:{click:function(e){return t.sortList("name")}}},[t._v("Filename")]),t._v(" "),r("v-flex",{attrs:{xs2:"","pl-2":"","pr-2":"","text-xs-center":""}},[t._v("Properties")]),t._v(" "),r("v-flex",{staticClass:"sortable",attrs:{xs1:"","pl-2":"","pr-2":"","text-xs-center":""},on:{click:function(e){return t.sortList("size")}}},[t._v("Size")]),t._v(" "),r("v-flex",{attrs:{xs2:"","pl-2":"","pr-2":"","text-xs-center":""}},[t._v("Actions")])],1),t._v(" "),t._l(t.imageList,function(e,n){return r("v-layout",{key:"image-"+n,staticStyle:{"border-bottom":"1px solid #ccc"},attrs:{"align-center":"",row:"",wrap:"","pb-1":""}},[r("v-flex",{attrs:{sm1:"",xs12:"","pl-2":"","pr-2":""}},[r("v-img",{attrs:{src:e.source,"aspect-ratio":1}})],1),t._v(" "),r("v-flex",{attrs:{sm4:"","pb-2":"",xs12:"","pl-2":"","pr-2":"","text-md-left":"","text-xs-center":""}},[t._v(" "+t._s(e.tooltip)),r("br"),t._v(" "),r("span",{staticClass:"grey--text"},[t._v("[position: "+t._s(e.tooltipPosition)+"]")])]),t._v(" "),r("v-flex",{attrs:{sm2:"",xs4:"","pl-2":"","pr-2":"","text-md-left":"","text-xs-center":""}},[t._v(t._s(e.name))]),t._v(" "),r("v-flex",{attrs:{sm2:"",xs4:"","pl-2":"","pr-2":"","text-xs-center":""}},[t._v(t._s(e.width)+" × "+t._s(e.height))]),t._v(" "),r("v-flex",{attrs:{sm1:"",xs4:"","pl-2":"","pr-2":"","text-xs-center":""}},[t._v(t._s((e.size/Math.pow(1024,2)).toFixed(2))+" MB")]),t._v(" "),r("v-flex",{attrs:{sm2:"",xs12:"","pl-2":"","pr-2":"","text-xs-center":""}},[r("v-btn",{attrs:{nuxt:"",to:"/image/"+e._id,small:"",block:t.$vuetify.breakpoint.smAndDown,flat:!t.$vuetify.breakpoint.smAndDown}},[r("v-icon",{attrs:{left:t.$vuetify.breakpoint.smAndDown}},[t._v("play_arrow")]),t._v(" "),r("span",{staticClass:"hidden-sm-and-up"},[t._v(" View")])],1),t._v(" "),r("v-btn",{attrs:{small:"",block:t.$vuetify.breakpoint.smAndDown,flat:!t.$vuetify.breakpoint.smAndDown},nativeOn:{click:function(r){return t.editImage(e)}}},[r("v-icon",{attrs:{left:t.$vuetify.breakpoint.smAndDown}},[t._v("edit")]),t._v(" "),r("span",{staticClass:"hidden-sm-and-up"},[t._v(" Edit")])],1),t._v(" "),r("v-btn",{attrs:{small:"",block:t.$vuetify.breakpoint.smAndDown,flat:!t.$vuetify.breakpoint.smAndDown},nativeOn:{click:function(r){t.imageToDelete=e._id}}},[r("v-icon",{attrs:{left:t.$vuetify.breakpoint.smAndDown}},[t._v("delete")]),t._v(" "),r("span",{staticClass:"hidden-sm-and-up"},[t._v(" Delete")])],1)],1)],1)})],2):t._e(),t._v(" "),r("div",{staticClass:"text-xs-center"},[r("v-pagination",{directives:[{name:"show",rawName:"v-show",value:t.pages>1,expression:"pages > 1"}],attrs:{length:t.pages},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}})],1)],1)],1)],1),t._v(" "),r("v-dialog",{attrs:{persistent:"",scrollable:"",overlay:!0,"max-width":"800px",transition:"dialog-transition"},model:{value:t.uploadDialog,callback:function(e){t.uploadDialog=e},expression:"uploadDialog"}},[r("v-card",[r("v-card-title",{staticClass:"headline grey lighten-2",attrs:{"primary-title":""}},[r("h2",[t.editMode?r("span",[t._v("Edit")]):r("span",[t._v("Upload")]),t._v(" image")])]),t._v(" "),r("v-card-text",[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{xs3:""}},[r("v-img",{directives:[{name:"show",rawName:"v-show",value:t.image.source,expression:"image.source"}],attrs:{"aspect-ratio":1,src:t.image.source}}),t._v(" "),r("img",{directives:[{name:"show",rawName:"v-show",value:t.image.source,expression:"image.source"}],ref:"image",attrs:{src:t.image.source,hidden:""}})],1),t._v(" "),r("v-flex",{attrs:{xs9:"","pl-4":""}},[r("p",[r("strong",[t._v("Filename:")]),t._v(" "+t._s(t.image.name))]),t._v(" "),r("p",[r("strong",[t._v("Size:")]),t._v(" "+t._s((t.image.size/Math.pow(1024,2)).toFixed(2))+" MB")]),t._v(" "),r("p",[r("strong",[t._v("Width and height")]),t._v(" "+t._s(t.image.width)+" × "+t._s(t.image.height))]),t._v(" "),r("p",[r("strong",[t._v("Uploaded at:")]),t._v(" "+t._s(t.image.createdAt.toLocaleString("ru",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"})))]),t._v(" "),r("v-text-field",{attrs:{name:"tooltip",label:"Add tooltip"},model:{value:t.image.tooltip,callback:function(e){t.$set(t.image,"tooltip",e)},expression:"image.tooltip"}}),t._v(" "),r("v-select",{attrs:{items:t.positions,label:"Tooltip position"},model:{value:t.image.tooltipPosition,callback:function(e){t.$set(t.image,"tooltipPosition",e)},expression:"image.tooltipPosition"}})],1)],1)],1),t._v(" "),r("v-card-actions",[r("v-spacer"),t._v(" "),r("v-btn",{nativeOn:{click:function(e){e.preventDefault(),t.uploadDialog=!1}}},[r("v-icon",{attrs:{left:""}},[t._v("close")]),t._v("Discard")],1),t._v(" "),t.editMode?r("v-btn",{attrs:{color:"primary"},nativeOn:{click:function(e){return e.preventDefault(),t.updateImage(e)}}},[r("v-icon",{attrs:{left:""}},[t._v("update")]),t._v("Update")],1):r("v-btn",{attrs:{color:"primary"},nativeOn:{click:function(e){return e.preventDefault(),t.saveImage(e)}}},[r("v-icon",{attrs:{left:""}},[t._v("save")]),t._v("Save")],1)],1)],1)],1),t._v(" "),r("v-dialog",{attrs:{value:t.error,scrollable:"",overlay:!0,"max-width":"500px",transition:"dialog-transition"}},[r("v-card",[r("v-card-title",{staticClass:"headline red lighten-1",attrs:{dark:"","primary-title":""}},[r("h2",{staticClass:"white--text"},[t._v("Error")])]),t._v(" "),r("v-card-text",[r("p",[t._v(t._s(t.error))])]),t._v(" "),r("v-card-actions",[r("v-spacer"),t._v(" "),r("v-btn",{on:{click:function(e){t.error=""}}},[t._v("Ok")])],1)],1)],1),t._v(" "),r("v-dialog",{attrs:{value:t.success,scrollable:"",overlay:!0,"max-width":"500px",transition:"dialog-transition"}},[r("v-card",[r("v-card-title",{staticClass:"headline green lighten-1",attrs:{dark:"","primary-title":""}},[r("h2",{staticClass:"white--text"},[t._v("Success")])]),t._v(" "),r("v-card-text",[r("p",[t._v(t._s(t.success))])]),t._v(" "),r("v-card-actions",[r("v-spacer"),t._v(" "),r("v-btn",{on:{click:function(e){t.success=""}}},[t._v("Ok")])],1)],1)],1),t._v(" "),r("v-dialog",{attrs:{value:t.imageToDelete,persistent:"",scrollable:"",overlay:!0,"max-width":"500px",transition:"dialog-transition"}},[r("v-card",[r("v-card-title",{staticClass:"headline blue lighten-1",attrs:{dark:"","primary-title":""}},[r("h2",{staticClass:"white--text"},[t._v("Confirmation")])]),t._v(" "),r("v-card-text",[r("p",[t._v("Are you sure you want to delete the image? This action can't be reversed.")])]),t._v(" "),r("v-card-actions",[r("v-spacer"),t._v(" "),r("v-btn",{on:{click:function(e){t.imageToDelete=""}}},[t._v("Cancel")]),t._v(" "),r("v-btn",{attrs:{color:"primary"},on:{click:t.removeImage}},[t._v("Ok")])],1)],1)],1)],1)},[],!1,null,null,null);e.default=component.exports}}]);